# Maintainer: Elaina Thompson <felinae@ulthar.cat>
pkgname=felvim
pkgver=8.2.3779
pkgrel=0
pkgdesc="Improved vi-style text editor"
url="https://www.vim.org/"
arch="all"
license="Vim"
subpackages="vim-doc"
makedepends="ncurses-dev"
source="vim-$pkgver.tar.gz::https://github.com/vim/vim/archive/v$pkgver.tar.gz
vimrc
"
builddir="$srcdir/vim-$pkgver"
options="!check"  # some tests are failing

build() {
	./configure                           \
		--build=$CBUILD                   \
		--disable-acl                     \
		--disable-arabic                  \
		--disable-canberra                \
		--disable-channel                 \
		--disable-darwin                  \
		--disable-desktop-database-update \
		--disable-gpm                     \
		--disable-gtktest                 \
		--disable-icon-cache-update       \
		--disable-libsodium               \
		--disable-netbeans                \
		--disable-nls                     \
		--disable-rightleft               \
		--disable-selinux	              \
		--disable-smack	                  \
		--disable-sysmouse                \
		--disable-xsmp                    \
		--disable-xsmp-interact           \
		--enable-autoservername           \
		--enable-cscope                   \
		--enable-gui=no                   \
		--enable-multibyte                \
		--host=$CHOST                     \
		--prefix=/usr                     \
		--with-compiledby="felinae"       \
		--with-features=tiny              \
		--without-x
	make
}

package() {
	make -j1 DESTDIR="$pkgdir/" install
	install -Dm644 "$srcdir"/vimrc "$pkgdir"/etc/vim/vimrc
}

sha512sums="
000e9c69ae5241451aca2b0af64cb10a063adddd53ea32f4cb0df7b79ce4bebb96d67c4c25d82fc301dc2ae47a5f16944cee61c1202c318c31256387b2193ef2  vim-8.2.3779.tar.gz
16dd1a8d3f54f2a98ddc812a7e0a8b16761b7f88f8e3ec2655a815e8d2e08326659743ca140150e9b1c2ca257d41622fa40cd554d1b1fbad72b65e0870998640  vimrc
"

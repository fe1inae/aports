# Maintainer: Elaina Thompson <felinae@ulthar.cat>
pkgname=astronaut
pkgver=0_git20220102
_commit=03db8ecfa8bee684a9bcd20ad5b158a69d4839a6
pkgrel=0
pkgdesc="Static git gemini viewer written in golang."
url="https://git.sr.ht/~kornellapacz/gmnigit"
license="MIT"
arch="all"
makedepends="go scdoc"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://git.sr.ht/~adnano/astronaut/archive/$_commit.tar.gz"
builddir="$srcdir/$pkgname-$_commit"
options="chmod-clean net"

export GOPATH="$srcdir"
export GOCACHE="$srcdir"
export GOTMPDIR="$srcdir"

build() {
    make
    gzip "$pkgname.1"
}

check() {
	go test .
}

package() {
	mkdir -p "$pkgdir/usr/bin"
	mkdir -p "$pkgdir/usr/share/man/man1"
	mkdir -p "$pkgdir/usr/share/astronaut"
	mkdir -p "$pkgdir/usr/share/man/man1"

	install -Dm755 "$pkgname" "$pkgdir/usr/bin"
	install -Dm644 "$pkgname.1.gz" "$pkgdir/usr/share/man/man1"
	install -Dm644 "config/astronaut.conf" "$pkgdir/usr/share/astronaut"
	install -Dm644 "config/style.conf" "$pkgdir/usr/share/astronaut"
}

sha512sums="
6561e6b87d7527bdd6bc37ad9e70de76444068a12c6f177a3533eaa51a58ec86cd8ba21af98236c4798a4b9db10c14fde3f86fb5ab15bc5cc176fb1d5c20eda5  astronaut-0_git20220102.tar.gz
"
